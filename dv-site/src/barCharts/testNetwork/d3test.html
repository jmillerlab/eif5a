<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Network Visualization</title>
    <!-- Include D3.js library -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
  </head>
  <body>
    <!-- Container for the network visualization -->
    <div id="network-container"></div>

    <script>
      // Create the SVG container
      const svg = d3
        .select("#network-container")
        .append("svg")
        .attr("width", 800)
        .attr("height", 600);

      // Load data from CSV file
      d3.csv("processed_network_data.csv")
        .then((data) => {
          // Create the links
          const link = svg
            .selectAll("line")
            .data(data)
            .enter()
            .append("line")
            .attr("stroke", "#999")
            .attr("stroke-width", "2px");

          // Create the nodes
          const node = svg
            .selectAll("circle")
            .data(data)
            .enter()
            .append("circle")
            .attr("r", 20)
            .attr("fill", "blue")
            .call(
              d3
                .drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended)
            );

          // Position the nodes
          node
            .attr("cx", (d) => Math.random() * 800)
            .attr("cy", (d) => Math.random() * 600);

          // Drag functions
          function dragstarted(event, d) {
            d3.select(this).raise().classed("active", true);
          }

          function dragged(event, d) {
            d3.select(this)
              .attr("cx", (d.x = event.x))
              .attr("cy", (d.y = event.y));
          }

          function dragended(event, d) {
            d3.select(this).classed("active", false);
          }
        })
        .catch((error) => {
          console.error("Error loading data:", error);
        });
    </script>
  </body>
</html>
